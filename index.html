<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Supplier Management</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    body {
      display: flex;
      min-height: 100vh;
      background: #f4f6f8;
      color: #1f2933;
    }
    .sidebar {
      width: 70px;
      background: #2b2bb2;
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 16px;
    }
    .logo {
      font-weight: 600;
      margin-bottom: 24px;
    }
    .nav-item {
      display: block;
      writing-mode: vertical-rl;
      transform: rotate(180deg);
      text-decoration: none;
      color: #c7d2ff;
      padding: 12px 0;
      font-size: 11px;
    }
    .nav-item.active,
    .nav-item:hover {
      color: #ffffff;
    }
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .topbar {
      height: 56px;
      background: #f9fafb;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 24px;
      border-bottom: 1px solid #e5e7eb;
    }
    .topbar h1 {
      font-size: 14px;
      letter-spacing: 2px;
    }
    .user-area {
      text-align: right;
      font-size: 12px;
    }
    .user-role {
      display: block;
      color: #6b7280;
    }
    .content {
      padding: 20px 24px;
    }
    .content-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      gap: 8px;
    }
    .content-header h2 {
      font-size: 16px;
    }
    .content-header input[type="text"] {
      flex: 1;
      max-width: 260px;
      padding: 6px 10px;
      font-size: 13px;
      border-radius: 4px;
      border: 1px solid #d1d5db;
    }
    .btn-primary {
      background: #2b2bb2;
      color: #fff;
      border: none;
      border-radius: 4px;
      padding: 8px 14px;
      font-size: 13px;
      cursor: pointer;
    }
    .btn-primary:hover {
      background: #23239a;
    }

    .supplier-form {
      padding: 12px 16px;
      margin-bottom: 12px;
      background: #ffffff;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      display: grid;
      gap: 8px;
    }
    .supplier-form h3 { font-size: 14px; }
    .supplier-form .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 8px;
      align-items: start;
    }
    .supplier-form label { font-size: 12px; color: #374151; }
    .supplier-form input[type="text"] { width: 100%; padding: 6px 8px; border-radius: 4px; border: 1px solid #d1d5db; font-size: 13px; }
    .form-actions { display:flex; gap:8px; justify-content:flex-end; }

    .filter-panel {
      padding: 12px 16px;
      margin-bottom: 12px;
      background: #ffffff;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      display: grid;
      gap: 8px;
    }
    .filter-panel .filter-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 8px;
      align-items: center;
    }
    .filter-panel label { font-size: 12px; color: #374151; }
    .filter-panel input[type="text"], .filter-panel select { width: 100%; padding: 6px 8px; border-radius: 4px; border: 1px solid #d1d5db; font-size: 13px; }

    .pagination {
      display: flex;
      gap: 6px;
      padding: 8px;
      justify-content: flex-end;
      align-items: center;
      background: #fff;
      border: 1px solid #e5e7eb;
      margin-top: 8px;
      border-radius: 6px;
      flex-wrap: wrap;
    }
    .page-btn {
      border: 1px solid #e5e7eb;
      background: #fff;
      padding: 6px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 13px;
    }
    .page-btn[disabled], .page-btn.disabled {
      opacity: 0.5;
      cursor: default;
    }
    .page-btn.active {
      background: #2b2bb2;
      color: #fff;
      border-color: #2b2bb2;
    }

    .table-wrapper {
      background: #ffffff;
      border-radius: 6px;
      border: 1px solid #e5e7eb;
      overflow-x: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }
    thead {
      background: #f3f4f6;
      text-align: left;
    }
    th,
    td {
      padding: 10px 12px;
      white-space: nowrap;
    }
    tbody tr:nth-child(even) {
      background: #f9fafb;
    }
    .badge {
      padding: 3px 10px;
      border-radius: 999px;
      font-size: 11px;
    }
    .badge-active {
      background: #dcfce7;
      color: #15803d;
    }
    .badge-inactive {
      background: #fee2e2;
      color: #b91c1c;
    }
    .icon-btn {
      border: none;
      background: transparent;
      cursor: pointer;
      font-size: 14px;
      margin-right: 4px;
    }
    @media (max-width: 768px) {
      .sidebar {
        display: none;
      }
      .topbar {
        padding: 0 12px;
      }
      .content {
        padding: 12px;
      }
    }
  </style>
</head>
<body>
  <aside class="sidebar">
    <div class="logo">Logo</div>
    <nav>
      <a href="#" class="nav-item active">Suppliers</a>
      <a href="#" class="nav-item">Products</a>
      <a href="#" class="nav-item">Orders</a>
      <a href="#" class="nav-item">Settings</a>
    </nav>
  </aside>

  <div class="main">
    <header class="topbar">
      <h1>SUPPLIER MANAGEMENT</h1>
      <div class="user-area">
        <span class="user-name">Invat User</span>
        <span class="user-role">Administrator</span>
      </div>
    </header>

    <section class="content">
      <div class="content-header">
  <h2>Suppliers</h2>
  <input type="text" id="search" placeholder="Search by Name or Supplier ID..." />
  <button id="filterBtn" class="btn-primary">Filter</button>
  <button id="sortBtn" class="btn-primary" aria-pressed="false" title="Toggle sort">Sort: A‚ÜíZ</button>
</div>

      <div id="supplierForm" class="supplier-form" style="display:none;">
        <h3>Add Supplier</h3>
        <div class="form-row">
          <label>Name<br /><input id="supplier-name" type="text" /></label>
          <label>Supplier ID<br /><input id="supplier-id" type="text" /></label>
          <label>Contact Number<br /><input id="supplier-contact" type="text" /></label>
          <label>Address Line 1<br /><input id="supplier-addr1" type="text" /></label>
          <label>Address Line 2<br /><input id="supplier-addr2" type="text" /></label>
          <label style="align-items:center; display:flex; gap:8px;">Active<br /><input id="supplier-active" type="checkbox" checked /></label>
        </div>
        <div class="form-actions">
          <button id="saveSupplierBtn" class="btn-primary">Save</button>
          <button id="cancelSupplierBtn" class="btn-primary" style="background:#e5e7eb;color:#111">Cancel</button>
        </div>
      </div>

      <div id="filterPanel" class="filter-panel" style="display:none;">
        <div class="filter-row">
          <label>Name<br /><select id="filter-name"></select></label>
          <label>Supplier ID<br /><select id="filter-id"></select></label>
        </div>
        <div class="form-actions">
          <button id="applyFilterBtn" class="btn-primary">Apply</button>
          <button id="clearFilterBtn" class="btn-primary" style="background:#e5e7eb;color:#111">Clear</button>
        </div>
      </div>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>SUPPLIER NAME</th>
              <th>SUPPLIER ID</th>
              <th>ADDRESS LINE 1</th>
              <th>ADDRESS LINE 2</th>
              <th>CONTACT NUMBER</th>
              <th>STATUS</th>
              <th>ACTIONS</th>
            </tr>
          </thead>
          <tbody id="supplierBody">
          </tbody>
        </table>
      </div>
      <div id="pagination" class="pagination" aria-label="Pagination"></div>
    </section>
  </div>

  <script>
    const STORAGE_KEY = "suppliers";

    const defaultSuppliers = [
      {
        _id: "1",
        name: "Alpha Traders",
        supplierId: "SUP001A1",
        contactNumber: "+971501234567",
        addressLine1: "Business Bay",
        addressLine2: "Office 101",
        active: true,
        userId: "user123"
      },
      {
        _id: "2",
        name: "Beta Supplies",
        supplierId: "SUP002B2",
        contactNumber: "+971502345678",
        addressLine1: "Deira Market",
        addressLine2: "Warehouse 5",
        active: false,
        userId: "user123"
      },
      {
        _id: "3",
        name: "Gamma Corporation",
        supplierId: "SUP003C3",
        contactNumber: "+971503456789",
        addressLine1: "Jumeirah",
        addressLine2: "Suite 10",
        active: true,
        userId: "user123"
      },
      {
        _id: "4",
        name: "Delta Wholesale",
        supplierId: "SUP004D4",
        contactNumber: "+971504567890",
        addressLine1: "Al Quoz",
        addressLine2: "",
        active: true,
        userId: "user456"
      },
      {
        _id: "5",
        name: "Epsilon Parts",
        supplierId: "SUP005E5",
        contactNumber: "+971505678901",
        addressLine1: "Sharjah Industrial Area",
        addressLine2: "Block B",
        active: false,
        userId: "user123"
      },
      {
        _id: "6",
        name: "Epsilon Parts",
        supplierId: "SUP005E5",
        contactNumber: "+971505678901",
        addressLine1: "Sharjah Industrial Area",
        addressLine2: "Block B",
        active: false,
        userId: "user123"
      },
      {
        _id: "7",
        name: "Epsilon Parts",
        supplierId: "SUP005E5",
        contactNumber: "+971505678901",
        addressLine1: "Sharjah Industrial Area",
        addressLine2: "Block B",
        active: false,
        userId: "user123"
      },
      {
        _id: "8",
        name: "Epsilon Parts",
        supplierId: "SUP005E5",
        contactNumber: "+971505678901",
        addressLine1: "Sharjah Industrial Area",
        addressLine2: "Block B",
        active: false,
        userId: "user123"
      }
    ];

    function loadSuppliers() {
      const stored = localStorage.getItem(STORAGE_KEY);
      if (!stored) {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(defaultSuppliers));
        return [...defaultSuppliers];
      }
      try {
        return JSON.parse(stored) || [];
      } catch {
        return [...defaultSuppliers];
      }
    }

    function saveSuppliers(suppliers) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(suppliers));
    }

    function populateFilterOptions() {
      const nameSelect = document.getElementById('filter-name');
      const idSelect = document.getElementById('filter-id');
      const suppliers = loadSuppliers();
      const names = Array.from(new Set(suppliers.map(s => (s.name || '').trim()).filter(Boolean))).sort((a,b) => a.localeCompare(b));
      const ids = Array.from(new Set(suppliers.map(s => (s.supplierId || '').trim()).filter(Boolean))).sort();

      if (nameSelect) {
        nameSelect.innerHTML = '<option value="">Any</option>';
        names.forEach(n => {
          const opt = document.createElement('option');
          opt.value = n;
          opt.textContent = n;
          nameSelect.appendChild(opt);
        });
      }
      if (idSelect) {
        idSelect.innerHTML = '<option value="">Any</option>';
        ids.forEach(id => {
          const opt = document.createElement('option');
          opt.value = id;
          opt.textContent = id;
          idSelect.appendChild(opt);
        });
      }
    }

    let currentSort = { field: 'name', direction: 'asc' };
    const PAGE_SIZE = 5; 
    let currentPage = 1;

    function renderSuppliers(filterText = "") {
      const tbody = document.getElementById("supplierBody");
      tbody.innerHTML = "";
      const suppliers = loadSuppliers();

      const headerSearch = (document.getElementById('search') ? document.getElementById('search').value.trim().toLowerCase() : '');

      const filtered = suppliers.filter(s => {
          if (!headerSearch) return true;
          const nameMatch = (s.name || '').toLowerCase().includes(headerSearch);
          const idMatch = (s.supplierId || '').toLowerCase().includes(headerSearch);
          return nameMatch || idMatch;
        });

      filtered.sort((a, b) => {
        const field = currentSort.field;
        const da = (a[field] || "").toString().toLowerCase();
        const db = (b[field] || "").toString().toLowerCase();
        if (da < db) return currentSort.direction === 'asc' ? -1 : 1;
        if (da > db) return currentSort.direction === 'asc' ? 1 : -1;
        return 0;
      });

      const total = filtered.length;
      const totalPages = Math.max(1, Math.ceil(total / PAGE_SIZE));
      if (currentPage > totalPages) currentPage = totalPages;
      const start = (currentPage - 1) * PAGE_SIZE;
      const pageItems = filtered.slice(start, start + PAGE_SIZE);

      pageItems.forEach(supplier => {
        const row = document.createElement("tr");
        row.dataset.id = supplier._id;
        row.innerHTML = `
          <td>${supplier.name}</td>
          <td>${supplier.supplierId}</td>
          <td>${supplier.addressLine1 || ""}</td>
          <td>${supplier.addressLine2 || ""}</td>
          <td>${supplier.contactNumber || ""}</td>
          <td>
            <span class="badge ${supplier.active ? "badge-active" : "badge-inactive"}">
              ${supplier.active ? "Active" : "Inactive"}
            </span>
          </td>
          <td>
            <button class="icon-btn edit">‚úè</button>
            <button class="icon-btn delete">üóë</button>
          </td>
        `;
        tbody.appendChild(row);
      });

      renderPagination(totalPages);
    }

    function renderPagination(totalPages) {
      const container = document.getElementById('pagination');
      if (!container) return;
      container.innerHTML = '';
      if (totalPages <= 1) return;

      const prev = document.createElement('button');
      prev.className = 'page-btn';
      prev.textContent = 'Prev';
      prev.dataset.page = 'prev';
      prev.disabled = currentPage === 1;
      container.appendChild(prev);

      for (let i = 1; i <= totalPages; i++) {
        const btn = document.createElement('button');
        btn.className = 'page-btn' + (i === currentPage ? ' active' : '');
        btn.textContent = i;
        btn.dataset.page = String(i);
        container.appendChild(btn);
      }

      const next = document.createElement('button');
      next.className = 'page-btn';
      next.textContent = 'Next';
      next.dataset.page = 'next';
      next.disabled = currentPage === totalPages;
      container.appendChild(next);
    }

    function createSupplier(supplier) {
      const suppliers = loadSuppliers();
      supplier._id = supplier._id || Date.now().toString();
      suppliers.push(supplier);
      saveSuppliers(suppliers);
      populateFilterOptions();
     
      currentPage = Math.ceil(suppliers.length / PAGE_SIZE);
      renderSuppliers();
    }

    function openSupplierForm() {
      const form = document.getElementById('supplierForm');
      if (!form) return;
      form.style.display = 'block';
      document.getElementById('supplier-name').value = '';
      document.getElementById('supplier-id').value = '';
      document.getElementById('supplier-contact').value = '';
      document.getElementById('supplier-addr1').value = '';
      document.getElementById('supplier-addr2').value = '';
      document.getElementById('supplier-active').checked = true;
    }

    function closeSupplierForm() {
      const form = document.getElementById('supplierForm');
      if (!form) return;
      form.style.display = 'none';
    }

    function getSupplierFormData() {
      return {
        name: document.getElementById('supplier-name').value.trim(),
        supplierId: document.getElementById('supplier-id').value.trim(),
        contactNumber: document.getElementById('supplier-contact').value.trim(),
        addressLine1: document.getElementById('supplier-addr1').value.trim(),
        addressLine2: document.getElementById('supplier-addr2').value.trim(),
        active: document.getElementById('supplier-active').checked,
        userId: 'user123'
      };
    }

    function deleteSupplier(id) {
      const suppliers = loadSuppliers();
      const updated = suppliers.filter(s => s._id !== id);
      saveSuppliers(updated);
      populateFilterOptions();

      const totalPages = Math.max(1, Math.ceil(updated.length / PAGE_SIZE));
      if (currentPage > totalPages) currentPage = totalPages;
      renderSuppliers();
    }

    document.addEventListener("DOMContentLoaded", () => {
      const tbody = document.getElementById("supplierBody");
      const searchInput = document.getElementById("search");
      const filterNameSelect = document.getElementById("filter-name");
      const filterIdSelect = document.getElementById("filter-id");
      const sortBtn = document.getElementById("sortBtn");
      const filterBtn = document.getElementById("filterBtn");
      const filterPanel = document.getElementById("filterPanel");
      const applyFilterBtn = document.getElementById("applyFilterBtn");
      const clearFilterBtn = document.getElementById("clearFilterBtn");

      const saveBtn = document.getElementById('saveSupplierBtn');
      const cancelBtn = document.getElementById('cancelSupplierBtn');

      function updateSortButton() {
        if (!sortBtn) return;
        sortBtn.textContent = currentSort.direction === 'asc' ? 'Sort: A‚ÜíZ' : 'Sort: Z‚ÜíA';
        sortBtn.setAttribute('aria-pressed', currentSort.direction === 'desc');
      }

      renderSuppliers();

      updateSortButton();

      populateFilterOptions();

      if (filterBtn && filterPanel) {
        filterBtn.addEventListener('click', () => {
          const isHidden = filterPanel.style.display === 'none' || !filterPanel.style.display;
          filterPanel.style.display = isHidden ? 'block' : 'none';
          if (isHidden) {
            populateFilterOptions();
            const tokens = (searchInput ? searchInput.value || '' : '').toLowerCase().split(/\s+/).filter(Boolean);
            if (filterNameSelect) {
              let found = null;
              for (const t of tokens) {
                const match = Array.from(filterNameSelect.options).find(o => o.value.toLowerCase() === t);
                if (match) { found = match.value; break; }
              }
              filterNameSelect.value = found || '';
            }
            if (filterIdSelect) {
              let foundId = null;
              for (const t of tokens) {
                const match = Array.from(filterIdSelect.options).find(o => o.value.toLowerCase() === t);
                if (match) { foundId = match.value; break; }
              }
              filterIdSelect.value = foundId || '';
            }
          }
        });
      }

      if (applyFilterBtn) {
        applyFilterBtn.addEventListener('click', () => {
          if (searchInput) {
            const combined = [filterNameSelect?.value.trim(), filterIdSelect?.value.trim()].filter(Boolean).join(' ');
            searchInput.value = combined;
          }
          currentPage = 1;
          renderSuppliers();
        });
      }

      if (clearFilterBtn) {
        clearFilterBtn.addEventListener('click', () => {
          if (filterNameSelect) filterNameSelect.value = '';
          if (filterIdSelect) filterIdSelect.value = '';
          if (searchInput) searchInput.value = '';
          currentPage = 1;
          renderSuppliers();
        });
      }

      tbody.addEventListener("click", e => {
        if (e.target.classList.contains("delete")) {
          const row = e.target.closest("tr");
          const id = row.dataset.id;
          deleteSupplier(id);
        }
      });

      if (searchInput) {
        searchInput.addEventListener("input", () => {
          currentPage = 1;
          renderSuppliers();
        });
      }



      if (sortBtn) {
        sortBtn.addEventListener('click', () => {
          currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
          currentPage = 1; 
          updateSortButton();
          renderSuppliers();
        });
      }

      const pagination = document.getElementById('pagination');
      if (pagination) {
        pagination.addEventListener('click', (e) => {
          const btn = e.target.closest('.page-btn');
          if (!btn || btn.disabled) return;
          const p = btn.dataset.page;
          if (p === 'prev') {
            if (currentPage > 1) currentPage -= 1;
          } else if (p === 'next') {
            currentPage += 1;
          } else {
            const pageNum = Number(p);
            if (!Number.isNaN(pageNum)) currentPage = pageNum;
          }
          renderSuppliers();
        });
      }

      if (saveBtn) {
        saveBtn.addEventListener('click', () => {
          const data = getSupplierFormData();
          if (!data.name || !data.supplierId) {
            alert('Please provide at least Name and Supplier ID.');
            return;
          }
          createSupplier(data);
          closeSupplierForm();
        });
      }

      if (cancelBtn) {
        cancelBtn.addEventListener('click', () => {
          closeSupplierForm();
        });
      }
    });
    
  </script>
</body>
</html>